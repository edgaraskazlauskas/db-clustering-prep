<!DOCTYPE >

<html>
  <head>
    <title>Graph UI</title>

    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <script src="scripts/cytoscape-markov-cluster.js"></script>
    <script src="https://unpkg.com/webcola/WebCola/cola.min.js"></script>
    <script src="https://cytoscape.org/cytoscape.js-cola/cytoscape-cola.js"></script>

    <style>
      #cy {
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        right: 0;
        z-index: 999;
      }
    </style>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        fetch("data/pet-clinic.json").then(async (response) => {
          const result = await response.json();

          const cy = (window.cy = cytoscape({
            container: document.getElementById("cy"),

            style: [
              {
                selector: "node",
                style: {
                  content: "data(id)",
                },
              },

              {
                selector: "edge",
                style: {
                  "curve-style": "bezier",
                  "target-arrow-shape": "triangle",
                  "line-color": "#dd4de2",
                  "target-arrow-color": "#dd4de2",
                  // label: "data(closeness)",
                  width: 2,
                  opacity: 0.666,
                },
              },

              {
                selector: ":selected",
                style: {},
              },
            ],

            elements: result,
            layout: {
              name: "cola",
              fit: true,
              padding: 30,
            },
          }));

          // Run Markov cluster on graph
          const clusters = cy.elements().markovCluster({
            attributes: [
              function (edge) {
                return edge.data("closeness");
              },
            ],
          });

          // Assign random colors to each cluster!
          for (let c = 0; c < clusters.length; c++) {
            clusters[c].style(
              "background-color",
              "#" + Math.floor(Math.random() * 16777215).toString(16)
            );
          }

          console.log(clusters);
        });
      });
    </script>
  </head>

  <body>
    <div id="cy"></div>
  </body>
</html>
